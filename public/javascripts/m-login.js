
Ext.onReady(function(){Ext.QuickTips.init();var win;var login=new Ext.FormPanel({labelWidth:80,url:'/map/login',frame:true,title:'GFUND LOGIN',defaultType:'textfield',items:[{fieldLabel:'Username',name:'user',allowBlank:false},{fieldLabel:'Password',name:'pass',inputType:'password',allowBlank:false,enableKeyEvents:true,listeners:{specialkey:function(field,el){if(el.getKey()==Ext.EventObject.ENTER)
Ext.getCmp('loginButton').fireEvent('click');}}}],buttonAlign:'center',buttons:[{text:'Login',id:'loginButton',formBind:true,listeners:{click:function(){login.getForm().submit({method:'POST',waitTitle:'Connecting',waitMsg:'Sending data...',success:function(form,action){win.hide();json=Ext.util.JSON.decode(action.response.responseText);amphoe=json.user;window.location="/map/show/"+amphoe;},failure:function(form,action){json=Ext.util.JSON.decode(action.response.responseText);Ext.Msg.alert('Login Failed!',json.msg);login.getForm().reset();}});}}},{text:'Update Profile',id:'profileButton',formBind:false,listeners:{click:function(){window.location="/user/profile/";}}}]});win=new Ext.Window({layout:'fit',width:300,height:150,closable:false,resizable:false,plain:true,border:false,items:[login]});win.show();});